import{u as f,j as s,a as m,S as p,f as g,r as x}from"./index-4CAIgBlp.js";import{A as j}from"./AppModal-O--df6WB.js";import{I as b}from"./ImageHeader-XXucsU0K.js";import"./GoBack-8-Gqgw5f.js";const w=({contact:e,isOpen:h,setIsOpen:a=()=>{},onLoadContact:l})=>{const d=f(),c=async t=>{try{await m.delete("/contacts/"+t),l()}catch(i){p.fire({icon:"error",text:i instanceof Error?i.message:"Unknown Error.",confirmButtonText:"はい"})}},o=async(t,i)=>{try{await m.put("/contacts/"+t,i),l()}catch(r){p.fire({icon:"error",text:r instanceof Error?r.message:"Unknown Error.",confirmButtonText:"はい"})}};return s.jsxs(j,{isOpen:h,setIsOpen:a,children:[s.jsxs("div",{children:[e==null?void 0:e.name,", ",(e==null?void 0:e.phone)||(e==null?void 0:e.email)]}),s.jsxs("div",{className:"grid-cols-2 gap-3 grid",children:[s.jsx("button",{children:s.jsx("img",{src:"/rsc/call_btn.png",width:120,className:"h-[77px]"})}),s.jsx("button",{children:s.jsx("img",{src:"/rsc/amend_btn.png",width:120,className:"h-[77px]"})}),(e==null?void 0:e.type)==="company"?s.jsx("button",{onClick:()=>o(e.id,{...e,type:"personal"}),children:s.jsx("img",{src:"/rsc/5.png",width:120,className:"h-[77px]"})}):e&&s.jsx("button",{onClick:()=>o(e.id,{...e,type:"company"}),children:s.jsx("img",{src:"/rsc/6.jpg",width:120,className:"h-[77px]"})}),s.jsx("button",{children:s.jsx("img",{src:"/rsc/goback_btn.png",onClick:()=>a(!1),width:120,className:"h-[77px]"})})]}),s.jsx("div",{children:s.jsx("button",{onClick:()=>d("/calling/send/"+(e==null?void 0:e.phone)),className:"w-full red-grad-bg py-3 text-white text-2xl font-bold rounded-md mt-3 border-4 border-red-600 shadow-lg",children:"履歴から削除"})}),s.jsx("div",{className:"flex justify-center mt-3",children:s.jsx("button",{onClick:()=>(e==null?void 0:e.id)&&c(e.id),children:s.jsx("img",{src:"/rsc/delete_btn.png",width:120,className:"h-[77px]"})})})]})},u="contacts"in navigator,C=()=>{const{type:e}=g(),[h,a]=x.useState([]),[l,d]=x.useState(!1),c=x.useRef();x.useEffect(()=>{if(e)o(e);else throw Error("Type Error.")},[e]);const o=async r=>{try{const{data:n}=await m.get("/contacts",{params:{type:r}});a(n)}catch(n){p.fire({icon:"error",text:n instanceof Error?n.message:"Unknown Error.",confirmButtonText:"はい"})}},t=async()=>{try{if(u&&e){const r=await navigator.contacts.select(["name","email","tel"],{multiple:!0});await m.post("/contacts",{contacts:r.filter(n=>n.tel),type:e}),o(e)}}catch(r){p.fire({icon:"error",text:r instanceof Error?r.message:"Unknown Error.",confirmButtonText:"はい"})}},i=r=>{c.current=r,d(!0)};return s.jsx(s.Fragment,{children:s.jsxs("div",{className:"bg-primary w-full h-full flex flex-col overflow-auto",children:[s.jsx(b,{}),s.jsxs("div",{className:"p-2 border-b border-solid border-gray-300 flex justify-between items-end",children:[s.jsx("div",{className:"text-red-400 text-xs",children:"連絡先リストが空です"}),e!=="all"&&u&&s.jsx("button",{onClick:t,className:"bg-[#00B050] py-1 px-2 shadow-md text-white",children:"連絡先をロード"})]}),s.jsx("div",{className:"h-full mt-1 overflow-auto flex flex-col",children:h.map((r,n)=>s.jsxs("div",{className:"border-b p-2 border-gray-300 rounded-sm",onClick:()=>i(r),children:[s.jsx("div",{children:r.name||"Unknown User"}),s.jsx("div",{className:"text-lg",children:r.phone||"No Phone Number"})]},n))}),s.jsx(w,{contact:c.current,isOpen:l,setIsOpen:d,onLoadContact:()=>e&&t()})]})})};export{C as default};
