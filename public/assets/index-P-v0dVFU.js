import{u,j as r,a as h,S as a,f as g,r as m}from"./index-rWFnIZfb.js";import{A as j}from"./AppModal-7bPrzVQu.js";import{I as b}from"./ImageHeader-1LpT8_Fq.js";import"./GoBack-b8r-Lhkr.js";const w=({contact:e,isOpen:p,setIsOpen:l=()=>{},onLoadContact:d})=>{const c=u(),x=async n=>{try{await h.delete("/contacts/"+n),d()}catch(t){a.fire({icon:"error",text:t instanceof Error?t.message:"Unknown Error.",confirmButtonText:"はい"})}},o=async(n,t)=>{try{await h.put("/contacts/"+n,t),d()}catch(s){a.fire({icon:"error",text:s instanceof Error?s.message:"Unknown Error.",confirmButtonText:"はい"})}};return r.jsxs(j,{isOpen:p,setIsOpen:l,children:[r.jsxs("div",{children:[e==null?void 0:e.name,", ",(e==null?void 0:e.phone)||(e==null?void 0:e.email)]}),r.jsxs("div",{className:"grid-cols-2 gap-3 grid",children:[r.jsx("button",{children:r.jsx("img",{src:"/rsc/call_btn.png",width:120,className:"h-[77px]"})}),r.jsx("button",{children:r.jsx("img",{src:"/rsc/amend_btn.png",width:120,className:"h-[77px]"})}),(e==null?void 0:e.type)==="company"?r.jsx("button",{onClick:()=>o(e.id,{...e,type:"personal"}),children:r.jsx("img",{src:"/rsc/5.png",width:120,className:"h-[77px]"})}):e&&r.jsx("button",{onClick:()=>o(e.id,{...e,type:"company"}),children:r.jsx("img",{src:"/rsc/6.jpg",width:120,className:"h-[77px]"})}),r.jsx("button",{children:r.jsx("img",{src:"/rsc/goback_btn.png",onClick:()=>l(!1),width:120,className:"h-[77px]"})})]}),r.jsx("div",{children:r.jsx("button",{onClick:()=>c("/calling/send/"+(e==null?void 0:e.phone)),className:"w-full red-grad-bg py-3 text-white text-2xl font-bold rounded-md mt-3 border-4 border-red-600 shadow-lg",children:"履歴から削除"})}),r.jsx("div",{className:"flex justify-center mt-3",children:r.jsx("button",{onClick:()=>(e==null?void 0:e.id)&&x(e.id),children:r.jsx("img",{src:"/rsc/delete_btn.png",width:120,className:"h-[77px]"})})})]})},f="contacts"in navigator,C=()=>{const{type:e}=g(),[p,l]=m.useState([]),[d,c]=m.useState(!1),x=m.useRef();m.useEffect(()=>{if(e)o(e);else throw Error("Type Error.")},[e]);const o=async s=>{try{const{data:i}=await h.get("/contacts",{params:{type:s}});l(i)}catch(i){a.fire({icon:"error",text:i instanceof Error?i.message:"Unknown Error.",confirmButtonText:"はい"})}},n=async()=>{try{if(f&&e){const s=await navigator.contacts.select(["name","email","tel"],{multiple:!0});a.fire({text:JSON.stringify(s)}),o(e)}}catch(s){a.fire({icon:"error",text:s instanceof Error?s.message:"Unknown Error.",confirmButtonText:"はい"})}},t=s=>{x.current=s,c(!0)};return r.jsx(r.Fragment,{children:r.jsxs("div",{className:"bg-primary w-full h-full flex flex-col overflow-auto",children:[r.jsx(b,{}),r.jsxs("div",{className:"p-2 border-b border-solid border-gray-300 flex justify-between items-end",children:[r.jsx("div",{className:"text-red-400 text-xs",children:"連絡先リストが空です"}),e!=="all"&&f&&r.jsx("button",{onClick:n,className:"bg-[#00B050] py-1 px-2 shadow-md text-white",children:"連絡先をロード"})]}),r.jsx("div",{className:"h-full mt-1 overflow-auto flex flex-col",children:p.map((s,i)=>r.jsxs("div",{className:"border-b p-2 border-gray-300 rounded-sm",onClick:()=>t(s),children:[r.jsx("div",{children:s.name||"Unknown User"}),r.jsx("div",{className:"text-lg",children:s.phone||"No Phone Number"})]},i))}),r.jsx(w,{contact:x.current,isOpen:d,setIsOpen:c,onLoadContact:()=>e&&n()})]})})};export{C as default};
