import{u as c,j as s,S as n,a as f,h as g,r as u}from"./index-Fbw3X_nj.js";import{A as j}from"./AppModal-SA0XheZN.js";import{I as w}from"./ImageHeader-g4Gi5ghX.js";import"./GoBack-BWUl0J2B.js";const b=({contact:e,isOpen:h,setIsOpen:l=()=>{},loadContact:d})=>{const m=c(),x=async t=>{try{const{isConfirmed:i}=await n.fire({icon:"warning",text:`Do you remove ${e==null?void 0:e.name} - ${e==null?void 0:e.phone}?`,showCancelButton:!0,confirmButtonText:"はい",cancelButtonText:"Reject"});i&&(await f.delete("/contacts/"+t),d(),await n.fire({icon:"success",text:"Deleted successfully.",confirmButtonText:"はい"}),l(!1))}catch(i){n.fire({icon:"error",text:i instanceof Error?i.message:"Unknown Error.",confirmButtonText:"はい"})}},a=async(t,i)=>{try{await f.put("/contacts/"+t,{contact:{name:e==null?void 0:e.name,phone:e==null?void 0:e.phone,email:e==null?void 0:e.email,type:i}}),await n.fire({icon:"success",text:"Updated successfully.",confirmButtonText:"はい"}),l(!1),d()}catch(r){n.fire({icon:"error",text:r instanceof Error?r.message:"Unknown Error.",confirmButtonText:"はい"})}};return s.jsxs(j,{isOpen:h,setIsOpen:l,children:[s.jsxs("div",{children:[e==null?void 0:e.name,", ",(e==null?void 0:e.phone)||(e==null?void 0:e.email)]}),s.jsxs("div",{className:"grid-cols-2 gap-3 grid",children:[s.jsx("button",{children:s.jsx("img",{src:"/rsc/call_btn.png",width:120,className:"h-[77px]"})}),s.jsx("button",{children:s.jsx("img",{src:"/rsc/amend_btn.png",width:120,className:"h-[77px]"})}),(e==null?void 0:e.type)==="company"?s.jsx("button",{onClick:()=>a(e.id,"personal"),children:s.jsx("img",{src:"/rsc/5.png",width:120,className:"h-[77px]"})}):e&&s.jsx("button",{onClick:()=>a(e.id,"company"),children:s.jsx("img",{src:"/rsc/6.jpg",width:120,className:"h-[77px]"})}),s.jsx("button",{children:s.jsx("img",{src:"/rsc/goback_btn.png",onClick:()=>l(!1),width:120,className:"h-[77px]"})})]}),s.jsx("div",{children:s.jsx("button",{onClick:()=>m("/calling/send/"+(e==null?void 0:e.phone)),className:"w-full red-grad-bg py-3 text-white text-2xl font-bold rounded-md mt-3 border-4 border-red-600 shadow-lg",children:"履歴から削除"})}),s.jsx("div",{className:"flex justify-center mt-3",children:s.jsx("button",{onClick:()=>(e==null?void 0:e.id)&&x(e.id),children:s.jsx("img",{src:"/rsc/delete_btn.png",width:120,className:"h-[77px]"})})})]})},p="contacts"in navigator,k=()=>{const{type:e}=g(),[h,l]=u.useState([]),[d,m]=u.useState(!1),x=u.useRef();u.useEffect(()=>{if(e)a(e);else throw Error("Type Error.")},[e]);const a=async r=>{try{const{data:o}=await f.get("/contacts",{params:{type:r}});l(o)}catch(o){n.fire({icon:"error",text:o instanceof Error?o.message:"Unknown Error.",confirmButtonText:"はい"})}},t=async()=>{try{if(p&&e){const r=await navigator.contacts.select(["name","email","tel"],{multiple:!0});n.fire({text:JSON.stringify(r)})}}catch(r){n.fire({icon:"error",text:r instanceof Error?r.message:"Unknown Error.",confirmButtonText:"はい"})}},i=r=>{x.current=r,m(!0)};return s.jsx(s.Fragment,{children:s.jsxs("div",{className:"bg-primary w-full h-full flex flex-col overflow-auto",children:[s.jsx(w,{}),s.jsxs("div",{className:"p-2 border-b border-solid border-gray-300 flex justify-between items-end",children:[s.jsx("div",{className:"text-red-400 text-xs",children:"連絡先リストが空です"}),e!=="all"&&p&&s.jsx("button",{onClick:t,className:"bg-[#00B050] py-1 px-2 shadow-md text-white",children:"連絡先をロード"})]}),s.jsx("div",{className:"h-full mt-1 overflow-auto flex flex-col",children:h.map((r,o)=>s.jsxs("div",{className:"border-b p-2 border-gray-300 rounded-sm",onClick:()=>i(r),children:[s.jsx("div",{children:r.name||"Unknown User"}),s.jsx("div",{className:"text-lg",children:r.phone||"No Phone Number"})]},o))}),s.jsx(b,{contact:x.current,isOpen:d,setIsOpen:m,loadContact:()=>e&&a(e)})]})})};export{k as default};
